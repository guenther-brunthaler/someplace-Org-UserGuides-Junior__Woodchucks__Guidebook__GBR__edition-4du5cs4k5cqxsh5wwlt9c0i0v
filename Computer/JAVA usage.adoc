JAVA Usage Advice
=================


Building a JAVA application from a tree of .java files
------------------------------------------------------

Sometimes one downloads JAVA source code for some project from somewhere, but has no clue how to compile and run it.

Normally, installing a build system such as `ant`, `maven`, `gradle` or `meson` would be required, or even installing a JAVA IDE such as Eclipse or Netbeans would be expected.

Those are huge installation, and you do not want to do that just for compiling a bunch of .java files.

The following procedure this avoided those installation in many situations, unless extended features such as autogenerated source files are used by the original toolchain.

The only thing which needs to be installed are the JDK and standard POSIX tools.

. Unpack the source files
+
--
If you got an archive of source files, unpack them into some working directory. E. g.

----
$ unzip -x SomeJavaProject.zip
----
--

. Find the top-level directory of the class hierarchy
+
--
First run

----
$ find . -name '*.java' | sed 's/./\\&/g' \
  | xargs sed '
	s|^import[^[:space:]]*[[:space:]]*||
	t 1
	d
	:1
	s/[;[:space:]]$//; s|\.|/|g
	s|/[^/]\{1,\}$|/|
	/java\// d
	/javax\// d
  ' | sort -u | less
----

which will show you all `import`-directories used in the .java source files. Now try to find a common base directory within the source tree from which all those subdirectories can be reached as relative pathnames.

Then use `cd` to go there, unless that directory already happens to be the current one.
--

. Delete any pre-built files
+
----
$ find . \( -name '*.class' -o -name '*.jar' \) -exec rm -- {} +
----

. Compile all .java files into .class files
+
----
$ find . -name '*.java' -exec javac {} +
----

. Find the name of the class file containing the main program
+
----
$ mainclass=`find -name *.java -exec grep -E \
  '^[[:space:]]([[:space:]]*(public|static|void|main)){4,}' \
  {} + | sed 's|^\./||; s/\.java:.*//'`; \
  echo "main class is: $mainclass"
----

. Run the application
+
----
$ java -cp . $mainclass
----


Pack the application into a single file
---------------------------------------

The above approach might work, but it is uncomfortable to ship a tree of .class files which need to be unpacked.

Therefore it would be better to pack them into a single .jar file which needs to be the only thing the user needs to download (in addition to an already-installed JRE of course).

. Build the .jar file
+
----
$ find -name *.class | sort | jar cfe my_output.jar $mainclass @/dev/stdin
----

. Run the application
+
----
$ java -jar my_output.jar
----
